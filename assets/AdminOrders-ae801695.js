import{M as E}from"./bootstrap.esm-434bcbc7.js";import{_ as M,o as d,c as n,b as e,t as r,D as c,H as u,F as h,f as b,C as y,d as g,G as _,I as m,r as f,e as p}from"./index-7bd3767d.js";const{VITE_URL:V,VITE_API:I}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_API:"sakimotorin-vue2022",BASE_URL:"/vue3-2022-week6/",MODE:"production",DEV:!1,PROD:!0},L={props:["tempOrder"],data(){return{orderModal:null,order:{user:{},products:{}}}},watch:{tempOrder(){this.order=this.tempOrder}},methods:{updateOrder(){const i=`${V}/api/${I}/admin/order/${this.tempOrder.id}`;this.$http.put(i,{data:this.order}).then(t=>{console.log(t.data)}).catch(t=>{console.log(t)}),alert("update order"),this.hideModal(),this.$emit("editOrder")},showModal(){this.orderModal.show()},hideModal(){this.orderModal.hide()}},mounted(){this.orderModal=new E(this.$refs.orderModal,{keyboard:!1,backdrop:"static"})}},$={class:"modal fade",tabindex:"-1","aria-labelledby":"orderModalLabel","aria-hidden":"true",ref:"orderModal"},w={class:"modal-dialog"},C={class:"modal-content border-0"},T={class:"modal-header"},U={class:"modal-title fs-5",id:"orderModalLabel"},A=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),D={key:0,class:"modal-body"},P={class:"mb-3 row"},R=e("label",{for:"staticName",class:"col-sm-3 col-form-label"},"收貨人姓名:",-1),N={class:"col-sm-9"},B={class:"mb-3 row"},S=e("label",{for:"staticEmail",class:"col-sm-3 col-form-label"},"收貨人電郵:",-1),F={class:"col-sm-9"},j={class:"mb-3 row"},q=e("label",{for:"staticTel",class:"col-sm-3 col-form-label"},"聯絡人電話:",-1),z={class:"col-sm-9"},G={class:"mb-3 row"},H=e("label",{for:"staticAddress",class:"col-sm-3 col-form-label"},"送貨地址:",-1),J={class:"col-sm-9"},K=e("hr",null,null,-1),Q={class:"mb-3 row"},W=e("h3",null,"Product List",-1),X={class:"table-responsive"},Y={class:"table"},Z=e("thead",null,[e("tr",null,[e("td",null,"項目"),e("td",{style:{width:"50px"}},"數量"),e("td",{class:"text-center"},"價格")])],-1),ee={class:"text-center"},te={class:"text-center"},se={class:"modal-footer"};function oe(i,t,v,O,s,a){return d(),n("div",$,[e("div",w,[e("div",C,[e("div",T,[e("h1",U," 訂單編號: "+r(v.tempOrder.id),1),A]),s.order.user?(d(),n("div",D,[e("div",P,[R,e("div",N,[c(e("input",{type:"text",readonly:"",class:"form-control-plaintext",id:"staticName","onUpdate:modelValue":t[0]||(t[0]=l=>s.order.user.name=l)},null,512),[[u,s.order.user.name]])])]),e("div",B,[S,e("div",F,[c(e("input",{type:"text",readonly:"",class:"form-control-plaintext",id:"staticEmail","onUpdate:modelValue":t[1]||(t[1]=l=>s.order.user.email=l)},null,512),[[u,s.order.user.email]])])]),e("div",j,[q,e("div",z,[c(e("input",{type:"text",class:"form-control",id:"staticTel","onUpdate:modelValue":t[2]||(t[2]=l=>s.order.user.tel=l)},null,512),[[u,s.order.user.tel]])])]),e("div",G,[H,e("div",J,[c(e("input",{type:"text",class:"form-control",id:"staticAddress","onUpdate:modelValue":t[3]||(t[3]=l=>s.order.user.address=l)},null,512),[[u,s.order.user.address]])])]),K,e("div",Q,[W,e("div",X,[e("table",Y,[Z,e("tbody",null,[(d(!0),n(h,null,b(s.order.products,l=>(d(),n("tr",{key:l.id},[e("td",null,r(l.product.title),1),e("td",ee,r(l.qty),1),e("td",te,r(l.total),1)]))),128))])])])])])):y("",!0),e("div",se,[e("button",{type:"button",class:"btn btn-primary",onClick:t[4]||(t[4]=l=>a.updateOrder())},"Save"),e("button",{type:"button",class:"btn btn-danger",onClick:t[5]||(t[5]=l=>a.hideModal())},"Cancel")])])])],512)}const le=M(L,[["render",oe]]),{VITE_URL:re,VITE_API:de}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_API:"sakimotorin-vue2022",BASE_URL:"/vue3-2022-week6/",MODE:"production",DEV:!1,PROD:!0},ne={data(){return{isLoading:!1,orders:[],tempOrder:{},pagination:{},orderMounted:!1}},components:{orderModal:le},methods:{getOrders(i=1){this.isLoading=!0,this.$http.get(`${re}/api/${de}/admin/orders/?page=${i}`).then(t=>{console.log(t.data),this.orders=t.data.orders,this.pagination=t.data.pagination,this.isLoading=!1,this.orderMounted=!0}).catch(t=>{console.log("admin orders error: "+t),this.isLoading=!1})},openOrderModal(i){this.tempOrder={...i},this.$refs.orderModal.showModal()}},mounted(){this.getOrders()}},ae=e("h2",{class:"text-center text-danger mb-4"},"後台產品訂單列表",-1),ie=e("hr",null,null,-1),ce={class:"table-responsive"},ue={class:"table"},_e=e("tr",null,[e("td",null,"訂單號碼"),e("td",null,"訂單狀態"),e("td",null,"訂單建立日期"),e("td",null,"訂單客戶資訊"),e("td")],-1),pe=e("br",null,null,-1),he=e("br",null,null,-1),me=e("br",null,null,-1),be=["onClick"],ve={key:0},ge={class:"pagination justify-content-center"},fe=e("span",{"aria-hidden":"true"},"«",-1),Me=[fe],ye=["onClick"],Oe=e("span",{"aria-hidden":"true"},"»",-1),xe=[Oe];function ke(i,t,v,O,s,a){const l=f("vue-loading"),x=f("orderModal");return d(),n(h,null,[g(l,{active:s.isLoading},null,8,["active"]),ae,ie,e("div",ce,[e("table",ue,[e("tbody",null,[_e,(d(!0),n(h,null,b(s.orders,o=>(d(),n("tr",{key:o.id},[e("td",null,r(o.id),1),e("td",null,[e("span",{class:_({"text-success":o.is_paid,"text-danger":!o.is_paid})},r(o.is_paid?"已付":"未付"),3)]),e("td",null,r(o.create_at),1),e("td",null,[p(" 收貨人姓名: "+r(o.user.name)+" ",1),pe,p(" 聯絡電郵: "+r(o.user.email)+" ",1),he,p(" 聯絡電話: "+r(o.user.tel)+" ",1),me,p(" 送貨地址: "+r(o.user.address),1)]),e("td",null,[e("button",{type:"button",class:"btn btn-primary",onClick:k=>a.openOrderModal(o)},"修改訂單",8,be)])]))),128))])]),g(x,{ref:"orderModal","temp-order":s.tempOrder,onEditOrder:a.getOrders},null,8,["temp-order","onEditOrder"]),s.orderMounted&&s.orders?(d(),n("nav",ve,[e("ul",ge,[e("li",{class:_(["page-item",{disabled:!s.pagination.has_pre}])},[e("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=m(o=>a.getOrders(s.pagination.current_page-1),["prevent"]))},Me)],2),(d(!0),n(h,null,b(s.pagination.total_pages,o=>(d(),n("li",{class:_(["page-item",{active:o===s.pagination.current_page}]),key:o+"page"},[e("a",{class:"page-link",href:"#",onClick:m(k=>a.getOrders(o),["prevent"])},r(o),9,ye)],2))),128)),e("li",{class:_(["page-item",{disabled:!s.pagination.has_next}])},[e("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=m(o=>a.getOrders(s.pagination.current_page+1),["prevent"]))},xe)],2)])])):y("",!0)])],64)}const Ie=M(ne,[["render",ke]]);export{Ie as default};
